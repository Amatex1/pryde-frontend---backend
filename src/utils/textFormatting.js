// Emoji shortcuts mapping
export const emojiShortcuts = {
  ':)': 'ğŸ˜Š',
  ':-)': 'ğŸ˜Š',
  ':D': 'ğŸ˜ƒ',
  ':-D': 'ğŸ˜ƒ',
  ';)': 'ğŸ˜‰',
  ';-)': 'ğŸ˜‰',
  ':(': 'ğŸ˜',
  ':-(': 'ğŸ˜',
  ':P': 'ğŸ˜›',
  ':-P': 'ğŸ˜›',
  ':p': 'ğŸ˜›',
  ':-p': 'ğŸ˜›',
  ':O': 'ğŸ˜®',
  ':-O': 'ğŸ˜®',
  ':o': 'ğŸ˜®',
  ':-o': 'ğŸ˜®',
  '<3': 'â¤ï¸',
  '</3': 'ğŸ’”',
  ':*': 'ğŸ˜˜',
  ':-*': 'ğŸ˜˜',
  'xD': 'ğŸ˜†',
  'XD': 'ğŸ˜†',
  ':\'(': 'ğŸ˜¢',
  ':-(': 'ğŸ˜',
  ':|': 'ğŸ˜',
  ':-|': 'ğŸ˜',
  ':/')': 'ğŸ˜•',
  ':-/': 'ğŸ˜•',
  '>:(': 'ğŸ˜ ',
  '>:-(': 'ğŸ˜ ',
  ':3': 'ğŸ˜º',
  'o.o': 'ğŸ˜³',
  'O.O': 'ğŸ˜³',
  '^_^': 'ğŸ˜Š',
  '-_-': 'ğŸ˜‘',
  'T_T': 'ğŸ˜­',
  '>_<': 'ğŸ˜£',
  ':thumbsup:': 'ğŸ‘',
  ':thumbsdown:': 'ğŸ‘',
  ':heart:': 'â¤ï¸',
  ':fire:': 'ğŸ”¥',
  ':star:': 'â­',
  ':100:': 'ğŸ’¯',
  ':clap:': 'ğŸ‘',
  ':pray:': 'ğŸ™',
  ':rainbow:': 'ğŸŒˆ',
  ':sparkles:': 'âœ¨',
  ':tada:': 'ğŸ‰',
  ':eyes:': 'ğŸ‘€',
  ':thinking:': 'ğŸ¤”',
  ':laugh:': 'ğŸ˜‚',
  ':cry:': 'ğŸ˜­',
  ':love:': 'ğŸ˜',
  ':kiss:': 'ğŸ˜˜',
  ':wink:': 'ğŸ˜‰',
  ':smile:': 'ğŸ˜Š',
  ':grin:': 'ğŸ˜',
  ':cool:': 'ğŸ˜',
  ':angry:': 'ğŸ˜ ',
  ':sad:': 'ğŸ˜¢',
  ':shocked:': 'ğŸ˜±',
  ':confused:': 'ğŸ˜•',
  ':neutral:': 'ğŸ˜',
  ':sleepy:': 'ğŸ˜´',
  ':sick:': 'ğŸ¤¢',
  ':party:': 'ğŸ¥³',
  ':sunglasses:': 'ğŸ˜',
  ':nerd:': 'ğŸ¤“',
  ':devil:': 'ğŸ˜ˆ',
  ':angel:': 'ğŸ˜‡',
  ':poop:': 'ğŸ’©',
  ':ghost:': 'ğŸ‘»',
  ':alien:': 'ğŸ‘½',
  ':robot:': 'ğŸ¤–',
  ':cat:': 'ğŸ±',
  ':dog:': 'ğŸ¶',
  ':monkey:': 'ğŸµ',
  ':pizza:': 'ğŸ•',
  ':burger:': 'ğŸ”',
  ':beer:': 'ğŸº',
  ':wine:': 'ğŸ·',
  ':coffee:': 'â˜•',
  ':cake:': 'ğŸ°',
  ':gift:': 'ğŸ',
  ':balloon:': 'ğŸˆ',
  ':music:': 'ğŸµ',
  ':camera:': 'ğŸ“·',
  ':phone:': 'ğŸ“±',
  ':computer:': 'ğŸ’»',
  ':book:': 'ğŸ“–',
  ':money:': 'ğŸ’°',
  ':crown:': 'ğŸ‘‘',
  ':gem:': 'ğŸ’',
  ':ring:': 'ğŸ’',
  ':lipstick:': 'ğŸ’„',
  ':dress:': 'ğŸ‘—',
  ':shoe:': 'ğŸ‘ ',
  ':bag:': 'ğŸ‘œ',
  ':umbrella:': 'â˜‚ï¸',
  ':sun:': 'â˜€ï¸',
  ':moon:': 'ğŸŒ™',
  ':cloud:': 'â˜ï¸',
  ':rain:': 'ğŸŒ§ï¸',
  ':snow:': 'â„ï¸',
  ':lightning:': 'âš¡',
  ':tree:': 'ğŸŒ²',
  ':flower:': 'ğŸŒ¸',
  ':rose:': 'ğŸŒ¹',
  ':earth:': 'ğŸŒ',
  ':rocket:': 'ğŸš€',
  ':plane:': 'âœˆï¸',
  ':car:': 'ğŸš—',
  ':bike:': 'ğŸš²',
  ':house:': 'ğŸ ',
  ':office:': 'ğŸ¢',
  ':hospital:': 'ğŸ¥',
  ':school:': 'ğŸ«',
  ':flag:': 'ğŸš©',
  ':check:': 'âœ…',
  ':x:': 'âŒ',
  ':warning:': 'âš ï¸',
  ':question:': 'â“',
  ':exclamation:': 'â—',
  ':plus:': 'â•',
  ':minus:': 'â–',
  ':left:': 'â¬…ï¸',
  ':right:': 'â¡ï¸',
  ':up:': 'â¬†ï¸',
  ':down:': 'â¬‡ï¸',
};

// Convert emoji shortcuts to actual emojis
export const convertEmojiShortcuts = (text) => {
  let result = text;
  
  // Sort shortcuts by length (longest first) to avoid partial replacements
  const sortedShortcuts = Object.keys(emojiShortcuts).sort((a, b) => b.length - a.length);
  
  sortedShortcuts.forEach(shortcut => {
    const emoji = emojiShortcuts[shortcut];
    // Use word boundaries for text shortcuts like :smile:
    if (shortcut.startsWith(':') && shortcut.endsWith(':')) {
      const regex = new RegExp(shortcut.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'g');
      result = result.replace(regex, emoji);
    } else {
      // For symbol shortcuts like :) or <3, replace with word boundaries
      const regex = new RegExp('(^|\\s)' + shortcut.replace(/[.*+?^${}()|[\]\\]/g, '\\$&') + '(?=\\s|$)', 'g');
      result = result.replace(regex, '$1' + emoji);
    }
  });
  
  return result;
};

// Format text with hashtags and mentions highlighted
export const formatTextWithLinks = (text) => {
  if (!text) return '';
  
  // Convert emoji shortcuts first
  let formattedText = convertEmojiShortcuts(text);
  
  // Split by spaces to process each word
  const parts = formattedText.split(/(\s+)/);
  
  return parts.map((part, index) => {
    // Check for hashtags
    if (part.match(/^#[\w]+$/)) {
      const tag = part.substring(1);
      return `<a href="/hashtag/${tag}" class="hashtag-link" key="${index}">${part}</a>`;
    }
    
    // Check for mentions
    if (part.match(/^@[\w]+$/)) {
      const username = part.substring(1);
      return `<span class="mention-link" data-username="${username}" key="${index}">${part}</span>`;
    }
    
    // Check for URLs
    if (part.match(/^https?:\/\/.+/)) {
      return `<a href="${part}" target="_blank" rel="noopener noreferrer" class="url-link" key="${index}">${part}</a>`;
    }
    
    return part;
  }).join('');
};

